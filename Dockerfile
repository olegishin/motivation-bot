# –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –ª–µ–≥–∫–∏–π –æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π –æ–±—Ä–∞–∑ Python
FROM python:3.11-slim

# –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ —Ä–æ–±–æ—á—É –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—é
WORKDIR /app

# –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¥–ª—è –∫–æ—Ä–µ–∫—Ç–Ω–æ–≥–æ –≤–∏–≤–æ–¥—É –ª–æ–≥—ñ–≤ —Ç–∞ —á–∞—Å–æ–≤–æ–≥–æ –ø–æ—è—Å—É
ENV PYTHONUNBUFFERED=1
ENV TZ=Europe/Kiev
RUN apt-get update && apt-get install -y tzdata && apt-get clean && rm -rf /var/lib/apt/lists/*

# –ö–æ–ø—ñ—é—î–º–æ —Ñ–∞–π–ª –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π —Ç–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ —ó—Ö
COPY requirements.txt .
RUN python -m pip install --upgrade pip && pip install --no-cache-dir -r requirements.txt

# üî• –ö–õ–Æ–ß–û–í–ò–ô –ö–†–û–ö: –ö–æ–ø—ñ—é—î–º–æ –∫–æ–Ω—Ç–µ–Ω—Ç –∑ –ª–æ–∫–∞–ª—å–Ω–æ—ó –ø–∞–ø–∫–∏ 'data_initial'
# –≤—Å–µ—Ä–µ–¥–∏–Ω—É –æ–±—Ä–∞–∑—É, —â–æ–± –ø–æ—Ç—ñ–º –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –π–æ–≥–æ –≤ –ø–æ—Å—Ç—ñ–π–Ω–µ —Å—Ö–æ–≤–∏—â–µ.
COPY data_initial/ /app/data_initial/

# –ö–æ–ø—ñ—é—î–º–æ –æ—Å–Ω–æ–≤–Ω–∏–π —Ñ–∞–π–ª –±–æ—Ç–∞
COPY fotinia_bot.py .

# –ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –∑–∞–ø—É—Å–∫—É –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞ –∑ –±–æ—Ç–æ–º
CMD ["uvicorn", "bot:app", "--host", "0.0.0.0", "--port", "8080"]
